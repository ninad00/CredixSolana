import{c as A,j as k,M as Z,q as e,x as C,y as R,D as X,F as ee,P as H}from"./index-CwPIP1s7.js";import{I as te,d as q,C as z,c as F,b as M}from"./source-8_iv8NpZ.js";import{B as D}from"./badge-v_hSFb5O.js";import{L as O}from"./loader-circle-C8JiTdZv.js";import{C as ne}from"./coins-BRcAJ8Rp.js";/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]],ae=A("chart-no-axes-column-increasing",se);/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],ie=A("hash",re);/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ce=A("search",oe);/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],de=A("shield-check",le);/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ue=A("users",me),U={address:"J4bfWKCuz2J1gzbwhosrhRV5Q1bQATjvAmnzP7SMYptY",instructions:[{name:"depositCollateral",discriminator:[156,131,142,116,146,247,162,120],args:[{name:"amount",type:"u64"}]},{name:"giveLiquidity",discriminator:[243,205,169,207,77,123,63,7],args:[{name:"amount",type:"u64"}]},{name:"liquidateUser",discriminator:[121,20,69,108,54,153,66,95],args:[{name:"debtToCover",type:"u64"},{name:"newPrice",type:"u64"}]},{name:"mintDsc",discriminator:[142,219,102,161,136,60,179,173],args:[{name:"amount",type:"u64"},{name:"newPrice",type:"u64"}]},{name:"redeemLiquidity",discriminator:[180,117,142,137,227,225,97,211],args:[]},{name:"startEngine",discriminator:[47,24,94,248,13,125,158,142],args:[{name:"liquidationThreshold",type:"u64"},{name:"minHealthFactor",type:"u64"},{name:"liquidationBonus",type:"u64"},{name:"feePercent",type:"u64"}]},{name:"startToken",discriminator:[253,172,159,168,69,117,168,65],args:[{name:"price",type:"u64"}]},{name:"temp",discriminator:[221,138,209,235,107,243,152,193],args:[{name:"hfbn",type:"u64"}]},{name:"withdrawCollateral",discriminator:[115,135,168,106,139,214,138,150],args:[{name:"dscToGive",type:"u64"},{name:"newPrice",type:"u64"}]}]},ge=n=>{const s=atob(n),t=new Uint8Array(s.length);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t},x=(n,s)=>{let t=0n;for(let r=0;r<8;r++)t|=BigInt(n[s+r])<<BigInt(r)*8n;return t},$=(n,s=6)=>{const t=BigInt(10**s),r=n/t,c=n%t;return c===0n?r.toString():`${r}.${c.toString().padStart(s,"0").replace(/0+$/,"")}`},he=n=>{var s;if((s=n.parsed)!=null&&s.type){const t=n.parsed.info||{};switch(n.parsed.type){case"transfer":return`Transferred ${t.amount||"unknown"} tokens from ${t.source||"unknown"} to ${t.destination||"unknown"}`;case"transferChecked":return`Transferred ${t.amount||"unknown"} tokens (checked) from ${t.source||"unknown"} to ${t.destination||"unknown"}`;case"mintTo":return`Minted ${t.amount||"unknown"} tokens to ${t.account||"unknown"}`;case"burn":return`Burned ${t.amount||"unknown"} tokens from ${t.account||"unknown"}`;case"approve":return`Approved ${t.delegate||"unknown"} to spend ${t.amount||"unknown"} tokens`;case"createAccount":return`Created account ${t.newAccount||"unknown"}`;case"closeAccount":return`Closed account ${t.account||"unknown"}`;case"initializeAccount":return`Initialized account ${t.account||"unknown"}`;case"initializeMint":return`Initialized mint with ${t.decimals||"unknown"} decimals`;default:return`${n.parsed.type} instruction`}}return n.program?`${n.program} program call`:"Unknown instruction"},J=n=>({[U.address]:"Interest Protocol","11111111111111111111111111111111":"System Program",TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA:"Token Program",ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL:"Associated Token Program"})[n]||`Unknown Program (${n.slice(0,8)}...)`,ye=n=>{var r,c,p;const s=(r=n.programId)==null?void 0:r.toString(),t=n.data;if(console.log("Decoding instruction:",{programId:s,data:t?t.slice(0,20)+"...":"no data"}),s===U.address&&t)try{const a=ge(t);if(console.log("Data bytes length:",a.length),console.log("First 8 bytes (discriminator):",Array.from(a.slice(0,8))),a.length>=8){const N=Array.from(a.slice(0,8));console.log("Looking for discriminator:",N);const b=U.instructions.find(l=>{const o=JSON.stringify(l.discriminator)===JSON.stringify(N);return console.log(`Checking ${l.name}:`,l.discriminator,"matches:",o),o});if(b){console.log("Found matching instruction:",b.name);const l={};let o="";switch(b.name){case"depositCollateral":{if(a.length>=16){const i=x(a,8);l.amount=i.toString(),o=`Deposited ${$(i)} as collateral`}else o="Deposited collateral";break}case"giveLiquidity":{if(a.length>=16){const i=x(a,8);l.amount=i.toString(),o=`Gave ${$(i)} liquidity`}else o="Gave liquidity";break}case"liquidateUser":{if(a.length>=24){const i=x(a,8),h=x(a,16);l.debtToCover=i.toString(),l.newPrice=h.toString(),o=`Liquidated user with debt ${$(i)}, price set to ${h}`}else o="Liquidated user";break}case"mintDsc":{if(a.length>=24){const i=x(a,8),h=x(a,16);l.amount=i.toString(),l.newPrice=h.toString(),o=`Minted DSC: ${$(i)}, price ${h}`}else o="Minted DSC";break}case"redeemLiquidity":{o="Redeemed liquidity";break}case"startEngine":{if(a.length>=40){const i=x(a,8),h=x(a,16),v=x(a,24),P=x(a,32);l.liquidationThreshold=i.toString(),l.minHealthFactor=h.toString(),l.liquidationBonus=v.toString(),l.feePercent=P.toString(),o=`Engine started (Threshold: ${i}, MinHF: ${h}, Bonus: ${v}, Fee: ${P}%)`}else o="Engine started";break}case"startToken":{if(a.length>=16){const i=x(a,8);l.price=i.toString(),o=`Token started with price ${i}`}else o="Token started";break}case"temp":{if(a.length>=16){const i=x(a,8);l.hfbn=i.toString(),o=`Temporary HF updated: ${i}`}else o="Temp instruction executed";break}case"withdrawCollateral":{if(a.length>=24){const i=x(a,8),h=x(a,16);l.dscToGive=i.toString(),l.newPrice=h.toString(),o=`Withdrew collateral (DSC: ${$(i)}, Price: ${h})`}else o="Withdrew collateral";break}default:o=`Unknown instruction: ${b.name}`}return{instructionName:b.name,summary:o,args:l,programId:s}}else console.log("No matching instruction found for discriminator:",N)}}catch(a){console.warn("Failed to decode instruction data:",a)}return{instructionName:((c=n.parsed)==null?void 0:c.type)||n.program||"Unknown",summary:he(n),args:((p=n.parsed)==null?void 0:p.info)||{},programId:s||"Unknown"}},V=te.toBase58(),xe="https://api.devnet.solana.com",Se=()=>{const[n,s]=k.useState(V),[t,r]=k.useState([]),[c,p]=k.useState(null),[a,N]=k.useState(!1),[b,l]=k.useState(!1),[o,i]=k.useState(null),[h,v]=k.useState(void 0),[P,T]=k.useState(!0),L=new Z(xe,"confirmed"),E=k.useCallback(g=>{const m={},d={},u=new Set;let y=0,w=null,S=null;return g.forEach(j=>{if(j.blockTime){const f=new Date(j.blockTime*1e3);(!w||f<w)&&(w=f),(!S||f>S)&&(S=f)}y+=j.fee,j.accounts.forEach(f=>u.add(f)),j.instructions.forEach(f=>{const G=J(f.programId);m[G]=(m[G]||0)+1,d[f.instructionName]=(d[f.instructionName]||0)+1})}),{totalTransactions:g.length,programCalls:m,instructionTypes:d,uniqueAccounts:u,dateRange:{earliest:w,latest:S},totalFees:y}},[]),K=g=>{var d;if(g.length===0)return"No instructions found";const m=g.filter(u=>u.programId===V).map(u=>u.summary);return m.length>0?m.join(", "):((d=g[0])==null?void 0:d.summary)||"Unknown Action"},_=async g=>{var d;const m=[];for(const u of g)try{await new Promise(w=>setTimeout(w,50));const y=await L.getParsedTransaction(u.signature,{maxSupportedTransactionVersion:0});if(y!=null&&y.transaction){const w=y.transaction.message.instructions.map(j=>ye(j)),S=Array.from(new Set(y.transaction.message.accountKeys.map(j=>j.pubkey.toString())));m.push({signature:u.signature,blockTime:u.blockTime??null,slot:u.slot||0,status:u.confirmationStatus||"unknown",instructions:w,accounts:S,fee:((d=y.meta)==null?void 0:d.fee)||0,humanSummary:K(w)})}}catch(y){console.warn(`Failed to process transaction ${u.signature}:`,y)}return m},W=async()=>{var g;if(!n.trim()){i("Please enter a valid program ID");return}N(!0),i(null),r([]),p(null),v(void 0),T(!0);try{const m=new H(n),d=await L.getSignaturesForAddress(m,{limit:25});if(d.length>0){const u=await _(d);r(u),p(E(u)),v((g=d[d.length-1])==null?void 0:g.signature),T(d.length===25)}else T(!1)}catch(m){i(m instanceof Error?m.message:"Failed to fetch transactions")}finally{N(!1)}},Q=async()=>{var g;if(!(!h||b)){l(!0);try{const m=new H(n),d=await L.getSignaturesForAddress(m,{limit:25,before:h});if(d.length>0){const u=await _(d),y=[...t,...u];r(y),p(E(y)),v((g=d[d.length-1])==null?void 0:g.signature),T(d.length===25)}else T(!1)}catch(m){i(m instanceof Error?m.message:"Failed to fetch more transactions")}finally{l(!1)}}},B={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,staggerChildren:.1}}},Y={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return e.jsx("div",{className:"w-full bg-gray-950 text-white min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-12 space-y-8",children:[e.jsxs(C.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white",children:"Transaction Analyzer"}),e.jsx("p",{className:"text-lg text-gray-400 mt-2",children:"Dive deep into Solana program activity."})]}),e.jsxs(q,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(z,{children:e.jsxs(F,{className:"flex items-center gap-3 text-xl text-white",children:[e.jsx(ce,{className:"h-5 w-5 text-purple-400"}),"Analyze Program"]})}),e.jsxs(M,{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-grow p-3 bg-gray-800 border border-gray-700 rounded-md text-gray-300 font-mono text-sm flex items-center break-all",children:n}),e.jsx(R,{onClick:W,disabled:a,className:"bg-purple-600 hover:bg-purple-700 text-white h-12 w-full sm:w-auto",children:a?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-5 w-5 mr-2 animate-spin"})," Analyzing..."]}):"Analyze Transactions"})]})]}),e.jsx(X,{children:o&&e.jsxs(C.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-red-900/30 text-red-400 text-sm p-3 border border-red-800 rounded-md flex items-start gap-2",children:[e.jsx(ee,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Error:"})," ",o]})]})}),c&&e.jsx(C.div,{variants:B,initial:"hidden",animate:"visible",children:e.jsxs(q,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(z,{children:e.jsx(F,{className:"text-xl text-white",children:"Analysis Summary"})}),e.jsxs(M,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(I,{icon:ie,value:c.totalTransactions,label:"Transactions"}),e.jsx(I,{icon:ue,value:c.uniqueAccounts.size,label:"Unique Accounts"}),e.jsx(I,{icon:ae,value:Object.keys(c.instructionTypes).length,label:"Instruction Types"}),e.jsx(I,{icon:ne,value:`${(c.totalFees/1e9).toFixed(6)} SOL`,label:"Total Fees"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx(fe,{title:"Top Instructions",data:c.instructionTypes}),e.jsx(pe,{title:"Top Programs Called",data:c.programCalls})]})]})]})}),t.length>0&&e.jsxs(C.div,{className:"space-y-4",variants:B,initial:"hidden",animate:"visible",children:[e.jsx("h2",{className:"text-2xl font-bold text-white pt-4",children:"Transaction Details"}),t.map(g=>e.jsx(C.div,{variants:Y,children:e.jsx(be,{tx:g})},g.signature)),P&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(R,{onClick:Q,disabled:b,variant:"outline",className:"border-gray-700 hover:bg-gray-800",children:b?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading More..."]}):"Load More"})})]})]})})},I=({icon:n,value:s,label:t})=>e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-4 flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-purple-600/20 border border-purple-500/30 rounded-md flex-shrink-0",children:e.jsx(n,{className:"h-6 w-6 text-purple-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-2xl font-bold text-white truncate",children:s}),e.jsx("div",{className:"text-sm text-gray-400",children:t})]})]}),pe=({title:n,data:s})=>e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-3 text-white",children:n}),e.jsx("div",{className:"space-y-2",children:Object.entries(s).sort(([,t],[,r])=>r-t).slice(0,5).map(([t,r])=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-300 capitalize truncate pr-2",children:t==="Unknown"?"Unrecognized Instruction":t}),e.jsx(D,{variant:"secondary",className:"bg-gray-700 text-gray-300 flex-shrink-0",children:r})]},t))})]}),fe=({title:n,data:s})=>{const t=Object.entries(s).sort(([,c],[,p])=>p-c).slice(0,5),r=Math.max(...t.map(([,c])=>c),0);return e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold mb-4 text-white",children:n}),e.jsx("div",{className:"space-y-3",children:t.map(([c,p])=>e.jsxs("div",{className:"grid grid-cols-[auto_1fr] items-center gap-3 text-sm",children:[e.jsx("span",{className:"text-gray-300 capitalize truncate text-right",children:c==="Unknown"?"Unrecognized":c}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-6 flex items-center",children:e.jsx("div",{className:"bg-purple-600 h-6 rounded-full flex items-center justify-end pr-2",style:{width:`${r>0?p/r*100:0}%`},children:e.jsx("span",{className:"text-white text-xs font-medium",children:p})})})]},c))})]})},be=({tx:n})=>e.jsxs(q,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(z,{children:e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx(F,{className:"text-lg font-medium text-white",children:n.humanSummary}),e.jsx("p",{className:"text-xs font-mono text-gray-500 mt-1 break-all",children:n.signature})]}),e.jsxs(D,{variant:n.status==="finalized"?"default":"secondary",className:"bg-green-600/20 text-green-400 border-green-500/30 flex-shrink-0",children:[e.jsx(de,{className:"h-3 w-3 mr-1.5"}),n.status]})]})}),e.jsx(M,{children:e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"cursor-pointer list-none flex items-center justify-between text-sm font-medium text-gray-400 hover:text-white",children:[e.jsx("span",{children:"View Details"}),e.jsx("span",{className:"transition-transform duration-300 group-open:rotate-180",children:"â–¼"})]}),e.jsx("div",{className:"mt-4 pl-4 border-l-2 border-gray-800 space-y-4",children:n.instructions.map((s,t)=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(D,{variant:"outline",className:"border-gray-700 text-gray-300",children:s.instructionName==="Unknown"?"Unrecognized":s.instructionName}),e.jsx("span",{className:"text-xs text-gray-500",children:J(s.programId)})]}),e.jsx("p",{className:"text-gray-300",children:s.summary}),Object.keys(s.args).length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 bg-gray-800/50 p-2 rounded-md font-mono",children:[e.jsx("h4",{className:"font-semibold text-gray-400 mb-1",children:"Arguments:"}),Object.entries(s.args).map(([r,c])=>e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsxs("span",{className:"flex-shrink-0",children:[r,":"]}),e.jsx("span",{className:"break-all text-right",children:String(c)})]},r))]})]},t))})]})})]});export{Se as default};
